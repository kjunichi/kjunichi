{"ts":1362969249696,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\n/**\n * Module dependencies.\n */\n\nvar express = require('express')\n  , routes = require('./routes');\n\nvar app = module.exports = express.createServer();\n\n// Configuration\n\napp.configure(function(){\n  app.set('views', __dirname + '/views');\n  app.set('view engine', 'ejs');\n  app.use(express.bodyParser());\n  app.use(express.methodOverride());\n  app.use(express.cookieParser());\n  app.use(express.session({ secret: 'your secret here' }));\n  app.use(app.router);\n  app.use(express.static(__dirname + '/public'));\n});\n\napp.configure('development', function(){\n  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));\n});\n\napp.configure('production', function(){\n  app.use(express.errorHandler());\n});\n\n// Routes\n\napp.get('/', routes.index);\n\napp.listen(3000);\nconsole.log(\"Express server listening on port %d in %s mode\", app.address().port, app.settings.env);\n"]],"start1":0,"start2":0,"length1":0,"length2":877}]],"length":877}
{"contributors":[],"silentsave":false,"ts":1362969308624,"patch":[[{"diffs":[[0,".listen("],[1,"process.env.PORT||"],[0,"3000);\nc"]],"start1":761,"start2":761,"length1":16,"length2":34}]],"length":895,"saved":false}
{"ts":1362969678668,"patch":[[{"diffs":[[-1,"\n/**\n * Module dep"],[1,"var express = require('express')\n, passport = require('passport')\n, util = require('util')\n, TwitterStrategy = require('passport-twitter').Strategy;\n \nvar TWITTER_CONSUMER_KEY = \"t4rLhP8en2QmGDLMyhg\";\nvar TWITTER_CONSUMER_SECRET = \"G1XYWz0uMWMp6xyHeXmedny4Rhvhy8Rem1dIPrGiAQ\";\n\n \n// Passport session setup.\n// To support persistent login sessions, Passport needs to be able to\n// serialize users into and deserialize users out of the session. Typically,\n// this will be as simple as storing the user ID when serializing, and finding\n// the user by ID wh"],[0,"en"],[1," "],[0,"de"],[-1,"ncies.\n */\n\nvar express = require('express')\n  , routes = require('./routes');\n\nvar app = module.exports"],[1,"serializing. However, since this example does not\n// have a database of user records, the complete Twitter profile is serialized\n// and deserialized.\npassport.serializeUser(function(user, done) {\ndone(null, user);\n});\n \npassport.deserializeUser(function(obj, done) {\ndone(null, obj);\n});\n \n \n// Use the TwitterStrategy within Passport.\n// Strategies in passport require a `verify` function, which accept\n// credentials (in this case, a token, tokenSecret, and Twitter profile), and\n// invoke a callback with a user object.\npassport.use(new TwitterStrategy({\nconsumerKey: TWITTER_CONSUMER_KEY,\nconsumerSecret: TWITTER_CONSUMER_SECRET,\ncallbackURL: \"http://twoauthtest.kjunichi.c9.io/auth/twitter/callback\"\n},\nfunction(token, tokenSecret, profile, done) {\n// トークンとトークンシークレットをユーザ情報の中に入れて、API叩く際にこれを参照する。\nprofile.twitter_token = token;\nprofile.twitter_tokenSecret = tokenSecret;\n \n// asynchronous verification, for effect...\nprocess.nextTick(function () {\n// To keep the example simple, the user's Twitter profile is returned to\n// represent the logged-in user. In a typical application, you would want\n// to associate the Twitter account with a user record in your database,\n// and return that user instead.\nreturn done(null, profile);\n});\n}\n));\n \n \n \n \nvar app"],[0," = e"]],"start1":0,"start2":0,"length1":130,"length2":1820},{"diffs":[[0,"();\n"],[1," "],[0,"\n// "],[-1,"C"],[1,"c"],[0,"onfigur"],[-1,"ation\n"],[1,"e Express"],[0,"\napp"]],"start1":1839,"start2":1839,"length1":26,"length2":30},{"diffs":[[0,"e(function()"],[1," "],[0,"{\n"],[-1,"  "],[0,"app.set('vie"]],"start1":1878,"start2":1878,"length1":28,"length2":27},{"diffs":[[0," '/views');\n"],[-1,"  "],[0,"app.set('vie"]],"start1":1921,"start2":1921,"length1":26,"length2":24},{"diffs":[[0,"'ejs');\n"],[-1,"  "],[1,"app.use(express.logger());\napp.use(express.cookieParser());\n"],[0,"app.use("]],"start1":1956,"start2":1956,"length1":18,"length2":76},{"diffs":[[0,".bodyParser());\n"],[-1,"  "],[0,"app.use(express."]],"start1":2039,"start2":2039,"length1":34,"length2":32},{"diffs":[[0,"verride());\n"],[-1,"  "],[0,"app.use(expr"]],"start1":2078,"start2":2078,"length1":26,"length2":24},{"diffs":[[0,"ess."],[-1,"cookieParser());\n  app.use(express.session({ secret: 'your secret here' }"],[1,"session({ secret: 'keyboard cat' }));\n// Initialize Passport! Also use passport.session() middleware, to support\n// persistent login sessions (recommended).\napp.use(passport.initialize());\napp.use(passport.session("],[0,"));\n"],[-1,"  "],[0,"app."]],"start1":2102,"start2":2102,"length1":87,"length2":226},{"diffs":[[0,"outer);\n"],[-1,"  "],[0,"app.use("]],"start1":2337,"start2":2337,"length1":18,"length2":16},{"diffs":[[0,"});\n"],[1," \n "],[0,"\napp."],[-1,"configure('development', function(){\n  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));\n});\n\napp.configure('produ"],[1,"get('/', function(req, res){\nres.render('index', { user: req.user });\n});\n \napp.get('/account', ensureAuthenticated, function(req, res){\nres.render('account', { user: req.user });\n});\n \napp.get('/login', function(req, res){\nres.render('login', { user: req.user });\n});\n \n// GET /auth/twitter\n// Use passport.authenticate() as route middleware to authenticate the\n// request. The first step in Twitter authentication will involve redirecting\n// the user to twitter.com. After authorization, the Twitter will redirect\n// the user back to this application at /auth/twitter/callback\napp.get('/auth/twitter',\npassport.authenticate('twitter'),\nfunction(req, res){\n// The request will be redirected to Twitter for authentication, so this\n// function will not be called.\n});\n \n// GET /auth/twitter/callback\n// Use passport.authenticate() as route middleware to authenticate the\n// request. If authentication fails, the user will be redirected back to the\n// login page. Otherwise, the primary route fun"],[0,"ction"],[-1,"',"],[0," fun"]],"start1":2393,"start2":2393,"length1":158,"length2":1015},{"diffs":[[0,"tion"],[-1,"(){\n  app.use(express.errorHandler());\n});\n\n// Routes\n\napp.get('/', routes.index);\n"],[1," will be called,\n// which, in this example, will redirect the user to the home page.\napp.get('/auth/twitter/callback',\npassport.authenticate('twitter', { failureRedirect: '/login' }),\nfunction(req, res) {\nres.redirect('/');\n});\n \napp.get('/logout', function(req, res){\nreq.logout();\nres.redirect('/');\n});\n \n \napp.get('/search',ensureAuthenticated, function(req, res){\n// search tweets.\nvar twitter_oauth = new OAuth(\n\"https://api.twitter.com/oauth/request_token\",\n\"https://api.twitter.com/oauth/access_token\",\nkeys.consumerKey,\nkeys.consumerSecret,\n\"1.0\",\nnull,\n\"HMAC-SHA1\");\ntwitter_oauth.getProtectedResource(\n'https://api.twitter.com/1.1/search/tweets.json?q=kjunichi',\n'GET',\nreq.user.twitter_token,\nreq.user.twitter_token_secret,\nfunction(err, data, response) {\nif(err){\nres.send(err, 500);\nreturn;\n}\nres.render('search', { user: req.user, result: data });\n}\n);\n \n});\n \n "],[0,"\napp"]],"start1":3409,"start2":3409,"length1":91,"length2":885},{"diffs":[[0,"RT||"],[-1,"3"],[1,"5"],[0,"000);\n"],[-1,"console.log(\"Express server listening on port %d in %s mode\", app.address().port, app.settings.env);\n"],[1," \n \n// Simple route middleware to ensure user is authenticated.\n// Use this route middleware on any resource that needs to be protected. If\n// the request is authenticated (typically via a persistent login session),\n// the request will proceed. Otherwise, the user will be redirected to the\n// login page.\nfunction ensureAuthenticated(req, res, next) {\nif (req.isAuthenticated()) { return next(); }\nres.redirect('/login')\n}"]],"start1":4316,"start2":4316,"length1":112,"length2":434}]],"length":4750,"saved":false}
{"ts":1362970277709,"patch":[[{"diffs":[[0,"'util')\n"],[1,", OAuth = require(\"oauth\")\n"],[0,", Twitte"]],"start1":83,"start2":83,"length1":16,"length2":43}]],"length":4777,"saved":false}
{"ts":1362970347118,"patch":[[{"diffs":[[0,"'util')\n"],[1,"//"],[0,", OAuth "]],"start1":83,"start2":83,"length1":16,"length2":18},{"diffs":[[0,"h = new "],[1,"TwitterStrategy."],[0,"OAuth(\n\""]],"start1":3845,"start2":3845,"length1":16,"length2":32}]],"length":4795,"saved":false}
{"ts":1362970471102,"patch":[[{"diffs":[[0,"n\",\n"],[-1,"keys.consumerKey,\nkeys.consumerSecret"],[1,"TWITTER_CONSUMER_KEY,\nTWITTER_CONSUMER_SECRET"],[0,",\n\"1"]],"start1":3965,"start2":3965,"length1":45,"length2":53}]],"length":4803,"saved":false}
{"ts":1362970730780,"patch":[[{"diffs":[[0,"turn;\n}\n"],[1,"console.dir(data);\n"],[0,"res.rend"]],"start1":4265,"start2":4265,"length1":16,"length2":35}]],"length":4822,"saved":false}
{"ts":1362971529334,"patch":[[{"diffs":[[0,"l')\n"],[-1,"//, OA"],[1,", oa"],[0,"uth "]],"start1":87,"start2":87,"length1":14,"length2":12},{"diffs":[[0,"new "],[-1,"TwitterStrategy.OA"],[1,"oa"],[0,"uth("]],"start1":3847,"start2":3847,"length1":26,"length2":10}]],"length":4804,"saved":false}
{"ts":1362972941262,"patch":[[{"diffs":[[0,"ew oauth"],[1,".OAuth"],[0,"(\n\"https"]],"start1":3848,"start2":3848,"length1":16,"length2":22}]],"length":4810,"saved":false}
{"ts":1362973253112,"patch":[[{"diffs":[[0,"\n'GET',\n"],[1,"//"],[0,"req.user"]],"start1":4127,"start2":4127,"length1":16,"length2":18},{"diffs":[[0,"_token,\n"],[1,"//"],[0,"req.user"]],"start1":4153,"start2":4153,"length1":16,"length2":18},{"diffs":[[0,"secret,\n"],[1,"req.session.oauth.access_token,\nreq.session.oauth.access_token_secret,\n"],[0,"function"]],"start1":4186,"start2":4186,"length1":16,"length2":87}]],"length":4885,"saved":false}
{"ts":1362973479801,"patch":[[{"diffs":[[0,"SHA1\");\n"],[1,"\ntwitter_oauth.getOAuthAccessToken(\n    req.user.twitter_token,\n    req.user.twitter_token_secret,\n    false,\n    function(err, oauth_access_token, oauth_access_token_secret, results) {\n      if(err) {\n        res.send(err, 500);\n        return;\n      }\n      req.session.oauth = {\n        access_token: oauth_access_token,\n        access_token_secret: oauth_access_token_secret\n      };\n      "],[0,"twitter_"]],"start1":4023,"start2":4023,"length1":16,"length2":410},{"diffs":[[0,"source(\n"],[-1,""],[0,"'https:/"]],"start1":4453,"start2":4453,"length1":16,"length2":16},{"diffs":[[0,"secret,\n"],[1,"//"],[0,"req.sess"]],"start1":4580,"start2":4580,"length1":16,"length2":18},{"diffs":[[0,"_token,\n"],[1,"//"],[0,"req.sess"]],"start1":4614,"start2":4614,"length1":16,"length2":18},{"diffs":[[0,"a });\n}\n"],[-1,""],[0,");\n"],[1,"\n    }\n  );\n  \n\n"],[0," \n});\n \n"]],"start1":4803,"start2":4803,"length1":19,"length2":35}]],"length":5299,"saved":false}
{"ts":1362973644898,"patch":[[{"diffs":[[0,"secret,\n"],[-1,"//"],[0,"req.sess"]],"start1":4580,"start2":4580,"length1":18,"length2":16},{"diffs":[[0,"cess_token,\n"],[-1,"//"],[0,"req.session."]],"start1":4608,"start2":4608,"length1":26,"length2":24}]],"length":5295,"saved":false}
{"ts":1362975785792,"patch":[[{"diffs":[[0," = \""],[-1,"t4rLhP8en2QmGDLMyhg"],[1,"p8WFXZIIXk2hf6WUP7aoUA"],[0,"\";\nv"]],"start1":202,"start2":202,"length1":27,"length2":30},{"diffs":[[0," = \""],[-1,"G1XYWz0uMWMp6xyHeXmedny4Rhvhy8Rem1dIPrGiAQ"],[1,"th74f3RmmWgNe2WdBxxdCRAci3V794O1zqWfvP4d9c"],[0,"\";\n\n"]],"start1":258,"start2":258,"length1":50,"length2":50}]],"length":5298,"saved":false}
{"ts":1362975877165,"patch":[[{"diffs":[[0,"\n'GET',\n"],[-1,"//"],[0,"req.user"]],"start1":4524,"start2":4524,"length1":18,"length2":16},{"diffs":[[0,"_token,\n"],[-1,"//"],[0,"req.user"]],"start1":4548,"start2":4548,"length1":18,"length2":16},{"diffs":[[0,"secret,\n"],[1,"//"],[0,"req.sess"]],"start1":4579,"start2":4579,"length1":16,"length2":18},{"diffs":[[0,"cess_token,\n"],[1,"//"],[0,"req.session."]],"start1":4609,"start2":4609,"length1":24,"length2":26}]],"length":5298,"saved":false}
{"ts":1362975998789,"patch":[[{"diffs":[[0,");\n\n"],[-1,"twitter_oauth.getOAuthAccessToken(\n    req.user.twitter_token,\n    req.user.twitter_token_secret,\n    false,\n    function(err, oauth_access_token, oauth_access_token_secret, results) {\n      if(err) {\n        res.send(err, 500);\n        return;\n      }\n      req.session.oauth = {\n        access_token: oauth_access_token,\n        access_token_secret: oauth_access_token_secret\n      };\n"],[0,"    "]],"start1":4031,"start2":4031,"length1":395,"length2":8},{"diffs":[[0,");\n\n"],[-1,"    }\n  );\n"],[0,"  \n\n"]],"start1":4423,"start2":4423,"length1":19,"length2":8}]],"length":4900,"saved":false}
{"ts":1362976201375,"patch":[[{"diffs":[[0,"json"],[-1,"?q="],[1,"%3fq%3d"],[0,"kjun"]],"start1":4120,"start2":4120,"length1":11,"length2":15}]],"length":4904,"saved":false}
{"ts":1362976254686,"patch":[[{"diffs":[[0,"json"],[-1,"%3fq%3d"],[1,"?q="],[0,"kjun"]],"start1":4120,"start2":4120,"length1":15,"length2":11}]],"length":4900,"saved":false}
{"ts":1362976841736,"patch":[[{"diffs":[[0,"e', 'ejs');\n"],[1,"//"],[0,"app.use(expr"]],"start1":1982,"start2":1982,"length1":24,"length2":26}]],"length":4902,"saved":false}
{"ts":1362976922927,"patch":[[{"diffs":[[0,"onse) {\n"],[1,"    console.dir(req.user);\n"],[0,"if(err){"]],"start1":4301,"start2":4301,"length1":16,"length2":43}]],"length":4929,"saved":false}
{"ts":1362977088877,"patch":[[{"diffs":[[0,"witter_token"],[-1,"S"],[1,"_s"],[0,"ecret = toke"]],"start1":1429,"start2":1429,"length1":25,"length2":26}]],"length":4930,"saved":false}
{"ts":1362977338329,"patch":[[{"diffs":[[0,"ect('/');\n});\n \n"],[-1," \n"],[0,"app.get('/search"]],"start1":3738,"start2":3738,"length1":34,"length2":32},{"diffs":[[0,"search',"],[1," "],[0,"ensureAu"]],"start1":3764,"start2":3764,"length1":16,"length2":17},{"diffs":[[0,"icated, function"],[1," "],[0,"(req, res){\n// s"]],"start1":3786,"start2":3786,"length1":32,"length2":33},{"diffs":[[0,"eq, res)"],[1," "],[0,"{\n"],[1,"    "],[0,"// searc"]],"start1":3805,"start2":3805,"length1":18,"length2":23},{"diffs":[[0,"tweets.\n"],[1,"    "],[0,"var twit"]],"start1":3830,"start2":3830,"length1":16,"length2":20},{"diffs":[[0,".OAuth(\n"],[1,"        "],[0,"\"https:/"]],"start1":3871,"start2":3871,"length1":16,"length2":24},{"diffs":[[0,"token\",\n"],[1,"        "],[0,"\"https:/"]],"start1":3926,"start2":3926,"length1":16,"length2":24},{"diffs":[[0,"token\",\n"],[1,"    "],[0,"TWITTER_"]],"start1":3980,"start2":3980,"length1":16,"length2":20},{"diffs":[[0,"ER_KEY,\n"],[1,"    "],[0,"TWITTER_"]],"start1":4006,"start2":4006,"length1":16,"length2":20},{"diffs":[[0,"ET,\n"],[1,"        "],[0,"\"1.0\",\n"],[1,"    "],[0,"null,\n"],[1,"        "],[0,"\"HMA"]],"start1":4039,"start2":4039,"length1":21,"length2":41},{"diffs":[[0,"HA1\");\n\n"],[-1,"  "],[0,"    twit"]],"start1":4083,"start2":4083,"length1":18,"length2":16},{"diffs":[[0,"source(\n"],[1,"        "],[0,"'https:/"]],"start1":4123,"start2":4123,"length1":16,"length2":24},{"diffs":[[0,"i',\n"],[1,"        "],[0,"'GET',\n"],[1,"    "],[0,"req."]],"start1":4196,"start2":4196,"length1":15,"length2":27},{"diffs":[[0,"_token,\n"],[1,"    "],[0,"req.user"]],"start1":4235,"start2":4235,"length1":16,"length2":20},{"diffs":[[0,"secret,\n"],[1,"    "],[0,"//req.se"]],"start1":4270,"start2":4270,"length1":16,"length2":20},{"diffs":[[0,"_token,\n"],[1,"    "],[0,"//req.se"]],"start1":4308,"start2":4308,"length1":16,"length2":20},{"diffs":[[0,"secret,\n"],[1,"    "],[0,"function"],[1," "],[0,"(err, da"]],"start1":4353,"start2":4353,"length1":24,"length2":29},{"diffs":[[0,"response) {\n"],[1,"    "],[0,"    console."]],"start1":4386,"start2":4386,"length1":24,"length2":28},{"diffs":[[0,"r);\n"],[1,"        "],[0,"if(err)"],[1," "],[0,"{\n"],[1,"            "],[0,"res."]],"start1":4425,"start2":4425,"length1":17,"length2":38},{"diffs":[[0,"0);\n"],[-1,"return;\n}\n"],[1,"            return;\n        }\n        "],[0,"cons"]],"start1":4475,"start2":4475,"length1":18,"length2":46},{"diffs":[[0,"(data);\n"],[1,"        "],[0,"res.rend"]],"start1":4528,"start2":4528,"length1":16,"length2":24},{"diffs":[[0,"('search', {"],[1,"\n           "],[0," user: req.u"]],"start1":4554,"start2":4554,"length1":24,"length2":36},{"diffs":[[0,"eq.user,"],[1,"\n           "],[0," result:"]],"start1":4586,"start2":4586,"length1":16,"length2":28},{"diffs":[[0,"data"],[-1," });\n}\n);\n\n  \n\n "],[1,"\n        });\n    });"],[0,"\n});"],[1," \n"],[0,"\n \n "]],"start1":4615,"start2":4615,"length1":28,"length2":34}]],"length":5109,"saved":false}
{"ts":1362977506150,"patch":[[{"diffs":[[0,"(data);\n"],[1,"        var result;\n        result.data = data;\n"],[0,"        "]],"start1":4528,"start2":4528,"length1":16,"length2":64},{"diffs":[[0,"result: "],[-1,"data"],[1,"result"],[0,"\n       "]],"start1":4655,"start2":4655,"length1":20,"length2":22}]],"length":5159,"saved":false}
{"ts":1362977561603,"patch":[[{"diffs":[[0,"r result"],[1," = {}"],[0,";\n      "]],"start1":4546,"start2":4546,"length1":16,"length2":21}]],"length":5164,"saved":false}
{"ts":1362979280211,"patch":[[{"diffs":[[0,"a = data"],[1,".statues"],[0,";\n      "]],"start1":4579,"start2":4579,"length1":16,"length2":24}]],"length":5172,"saved":false}
{"ts":1362979287926,"patch":[[{"diffs":[[0,"data"],[-1,".statues"],[0,";\n  "]],"start1":4583,"start2":4583,"length1":16,"length2":8}]],"length":5164,"saved":false}
{"ts":1362979772487,"patch":[[{"diffs":[[0,"result: "],[-1,"result"],[1,"data.statuses"],[0,"\n       "]],"start1":4660,"start2":4660,"length1":22,"length2":29}]],"length":5171,"saved":false}
{"contributors":[],"silentsave":false,"ts":1363139491032,"patch":[[{"diffs":[[0,"ct.\n"],[-1,"passport.use("],[1,"var ts = "],[0,"new "]],"start1":1107,"start2":1107,"length1":21,"length2":17},{"diffs":[[0,"cret;\n \n"],[1," console.dir(ts._oauth);\n //console.log(ts.options);\n \n"],[0,"// async"]],"start1":1454,"start2":1454,"length1":16,"length2":71},{"diffs":[[0,"\n}\n)"],[-1,");\n \n \n "],[1,";\npassport.use(ts);"],[0,"\n \nv"]],"start1":1876,"start2":1876,"length1":16,"length2":27},{"diffs":[[0,"req, res) {\n"],[1,"    var keyword = req.query[\"keyword\"];\n    if(!keyword||keyword === \"\") {\n        keyword = \"kjunichi\";\n    }\n"],[0,"    // searc"]],"start1":3866,"start2":3866,"length1":24,"length2":135},{"diffs":[[0,"tweets.\n"],[-1,""],[0,"    var "]],"start1":4003,"start2":4003,"length1":16,"length2":16},{"diffs":[[0,"SHA1\");\n"],[1,"    ts._oauth.getProtectedResource("],[0,"\n    "],[1,"//"],[0,"twitter_"]],"start1":4255,"start2":4255,"length1":21,"length2":58},{"diffs":[[0,"n?q="],[-1,"kjunichi'"],[1,"'+keyword"],[0,",\n  "]],"start1":4395,"start2":4395,"length1":17,"length2":17},{"diffs":[[0,"      }\n        "],[1,"//"],[0,"console.dir(data"]],"start1":4711,"start2":4711,"length1":32,"length2":34},{"diffs":[[0,"var "],[-1,"result = {};\n        result.data = data"],[1,"jsonObj = JSON.parse(data)"],[0,";\n  "]],"start1":4756,"start2":4756,"length1":47,"length2":34},{"diffs":[[0,"lt: "],[-1,"data.statuses"],[1,"jsonObj"],[0,"\n   "]],"start1":4863,"start2":4863,"length1":21,"length2":15}]],"length":5364,"saved":false}
{"ts":1363139555509,"patch":[[{"diffs":[[0,"\n);\n"],[-1,"passport.use(ts);"],[0,"\n \nv"]],"start1":1878,"start2":1878,"length1":25,"length2":8},{"diffs":[[0,"tion(req, res){\n"],[1,"    passport.use(ts);\n"],[0,"res.render('inde"]],"start1":2496,"start2":2496,"length1":32,"length2":54}]],"length":5369,"saved":false}
{"ts":1363139605903,"patch":[[{"diffs":[[0,";\n});\n \n"],[-1," "],[0,"\napp.get"]],"start1":2469,"start2":2469,"length1":17,"length2":16}]],"length":5368,"saved":false}
{"ts":1363145790548,"patch":[[{"diffs":[[0,"req, res) {\n"],[1,"    console.dir(req.user);\n"],[0,"    var keyw"]],"start1":3870,"start2":3870,"length1":24,"length2":51}]],"length":5395,"saved":false}
{"ts":1363145907200,"patch":[[{"diffs":[[0,";\n});\n \napp."],[-1,"ge"],[1,"pos"],[0,"t('/search',"]],"start1":3812,"start2":3812,"length1":26,"length2":27},{"diffs":[[0,";\n}); \n\n"],[1,"app.get('/search', ensureAuthenticated, function (req, res) {\n    console.dir(req.user);\n    var keyword = req.query[\"keyword\"];\n    if(!keyword||keyword === \"\") {\n        keyword = \"kjunichi\";\n    }\n    // search tweets.\n    var twitter_oauth = new oauth.OAuth(\n        \"https://api.twitter.com/oauth/request_token\",\n        \"https://api.twitter.com/oauth/access_token\",\n    TWITTER_CONSUMER_KEY,\n    TWITTER_CONSUMER_SECRET,\n        \"1.0\",\n    null,\n        \"HMAC-SHA1\");\n    ts._oauth.getProtectedResource(\n    //twitter_oauth.getProtectedResource(\n        'https://api.twitter.com/1.1/search/tweets.json?q='+keyword,\n        'GET',\n    req.user.twitter_token,\n    req.user.twitter_token_secret,\n    //req.session.oauth.access_token,\n    //req.session.oauth.access_token_secret,\n    function (err, data, response) {\n        console.dir(req.user);\n        if(err) {\n            res.send(err, 500);\n            return;\n        }\n        //console.dir(data);\n        var jsonObj = JSON.parse(data);\n        res.render('search', {\n            user: req.user,\n            result: jsonObj\n        });\n    });\n});"],[0," \n \napp."]],"start1":4925,"start2":4925,"length1":16,"length2":1125}]],"length":6505,"saved":false}
{"ts":1363146731194,"patch":[[{"diffs":[[0,"req, res) {\n    "],[1,"res.contentType('application/json');\n    \n    //"],[0,"console.dir(req."]],"start1":3871,"start2":3871,"length1":32,"length2":80},{"diffs":[[0,"ON.parse(data);\n"],[1,"        /*\n"],[0,"        res.rend"]],"start1":4852,"start2":4852,"length1":32,"length2":43},{"diffs":[[0,"Obj\n        });\n"],[1,"        */\n        res.send(data);\n"],[0,"    });\n}); \n\nap"]],"start1":4962,"start2":4962,"length1":32,"length2":67}]],"length":6599,"saved":false}
{"ts":1363147533170,"patch":[[{"diffs":[[0,"res."],[-1,"send(data"],[1,"json(200,jsonObj"],[0,");\n "]],"start1":4997,"start2":4997,"length1":17,"length2":24}]],"length":6606,"saved":false}
{"ts":1363147657435,"patch":[[{"diffs":[[0,"son("],[-1,"200,"],[0,"json"]],"start1":5002,"start2":5002,"length1":12,"length2":8}]],"length":6602,"saved":false}
{"ts":1363150299310,"patch":[[{"diffs":[[0,"ce(\n"],[-1,"    //twitter_oauth.getProtectedResource(\n"],[0,"    "]],"start1":4375,"start2":4375,"length1":50,"length2":8},{"diffs":[[0,"et,\n"],[-1,"    //req.session.oauth.access_token,\n    //req.session.oauth.access_token_secret,\n"],[0,"    "]],"start1":4522,"start2":4522,"length1":91,"length2":8},{"diffs":[[0,"ta);"],[-1,"\n        /*\n        res.render('search', {\n            user: req.user,\n            result: jsonObj\n        });\n        */"],[0,""],[1,""],[0,"\n   "]],"start1":4738,"start2":4738,"length1":129,"length2":8}]],"length":6356,"saved":false}
{"ts":1363150310296,"patch":[[{"diffs":[[0,"onse) {\n        "],[1,"//"],[0,"console.dir(req."]],"start1":4555,"start2":4555,"length1":32,"length2":34}]],"length":6358,"saved":false}
{"contributors":[],"silentsave":false,"ts":1363220109922,"patch":[[{"diffs":[[0,"    "],[-1,"var twitter_oauth = new oauth.OAuth(\n        \"https://api.twitter.com/oauth/request_token\",\n        \"https://api.twitter.com/oauth/access_token\",\n    TWITTER_CONSUMER_KEY,\n    TWITTER_CONSUMER_SECRET,\n        \"1.0\",\n    null,\n        \"HMAC-SHA1\");"],[0,"\n   "]],"start1":4091,"start2":4091,"length1":255,"length2":8}]],"length":6111,"saved":false}
{"contributors":[],"silentsave":false,"ts":1372984763542,"patch":[[{"diffs":[[0,"uth\")\n, "],[-1,""],[0,""],[1,"querystring = require(\"querystring\")\n, "],[0,"TwitterS"]],"start1":112,"start2":112,"length1":16,"length2":55},{"diffs":[[0,");\n}\n);\n"],[-1,"\n"],[0," \nvar ap"]],"start1":1913,"start2":1913,"length1":17,"length2":16},{"diffs":[[0,"ress"],[-1,".createServer"],[0,""],[1,""],[0,"();\n"]],"start1":1936,"start2":1936,"length1":21,"length2":8},{"diffs":[[0,"s);\n"],[-1,"res.render('index', { user: req.user });"],[1,"    var timeline={};\n    if (req.isAuthenticated()) {\n        ts._oauth.getProtectedResource(\n            'https://api.twitter.com/1.1/statuses/home_timeline.json',\n            'GET',\n            req.user.twitter_token,\n            req.user.twitter_token_secret,\n            function (err, data, response) {\n                if(err) {\n                   res.send(err, 500);\n                    return;\n                }\n        \n                var jsonObj = JSON.parse(data);\n                res.render('index', {\n                    user: req.user,\n                    result: jsonObj\n                });\n            }\n        );\n    } else {\n        res.render('index', { user: req.user,result:null });\n    }"],[0,"\n});"]],"start1":2554,"start2":2554,"length1":48,"length2":718},{"diffs":[[0,"\nres.redirect('/"],[-1,""],[0,""],[1,"search"],[0,"');\n});\n \napp.ge"]],"start1":4411,"start2":4411,"length1":32,"length2":38},{"diffs":[[0,"app."],[-1,"pos"],[1,"ge"],[0,"t('/"],[-1,"search"],[1,"listlist"],[0,"', e"]],"start1":4521,"start2":4521,"length1":21,"length2":22},{"diffs":[[0,"    "],[-1,"res.contentType('application/json'"],[1,"\n    ts._oauth.getProtectedResource(\n        'https://api.twitter.com/1.1/lists/list.json',\n        'GET',\n        req.user.twitter_token,\n        req.user.twitter_token_secret,\n        function (err, data, response) {\n            \n            if(err) {\n                res.send(err, 500);\n                return;\n            }\n        \n            var jsonObj = JSON.parse(data);\n            res.render('listlist', {\n                user: req.user,\n                result: jsonObj\n            }"],[0,");\n    "],[1,"  "],[1,"  }"],[0,"\n    "],[-1,"//"],[1,");\n}); \n\napp.get('/list', ensureAuthenticated, function (req, res) {\n    "],[0,"cons"]],"start1":4585,"start2":4585,"length1":56,"length2":593},{"diffs":[[0,".user);\n    var "],[-1,"keywor"],[1,"listi"],[0,"d = req.query[\"k"]],"start1":5189,"start2":5189,"length1":38,"length2":37},{"diffs":[[0,"id = req.query[\""],[-1,"keywor"],[1,"listi"],[0,"d\"];\n    if(!key"]],"start1":5209,"start2":5209,"length1":38,"length2":37},{"diffs":[[0,"\"];\n    if(!"],[-1,"keyword||keywor"],[1,"listid||listi"],[0,"d === \"\") {\n"]],"start1":5231,"start2":5231,"length1":39,"length2":37},{"diffs":[[0,"    "],[-1,"keyword = \"kjunichi\";\n    }\n    // search tweets.\n "],[1,"listid = \"78331407\";\n    }\n"],[0,"   \n"]],"start1":5272,"start2":5272,"length1":59,"length2":35},{"diffs":[[0,"1.1/"],[-1,"search/tweets.json?q='+keyword"],[1,"lists/statuses.json?list_id='+listid+\"&count=100\""],[0,",\n  "]],"start1":5376,"start2":5376,"length1":38,"length2":57},{"diffs":[[0,"     'GET',\n    "],[1,"  "],[1,"  "],[0,"req.user.twitter"]],"start1":5434,"start2":5434,"length1":32,"length2":36},{"diffs":[[0,".twitter_token,\n"],[1,"    "],[0,"    req.user.twi"]],"start1":5462,"start2":5462,"length1":32,"length2":36},{"diffs":[[0,"ken_secret,\n    "],[1,"  "],[1,"  "],[0,"function (err, d"]],"start1":5505,"start2":5505,"length1":32,"length2":36},{"diffs":[[0,"    "],[-1,"    //console.dir(req.user);\n"],[0,"    "]],"start1":5558,"start2":5558,"length1":37,"length2":8},{"diffs":[[0,") {\n            "],[1,"    "],[0,"res.send(err, 50"]],"start1":5576,"start2":5576,"length1":32,"length2":36},{"diffs":[[0,"send(err, 500);\n"],[1,"    "],[0,"            retu"]],"start1":5600,"start2":5600,"length1":32,"length2":36},{"diffs":[[0,"return;\n        "],[1,"    "],[0,"}\n        //cons"]],"start1":5632,"start2":5632,"length1":32,"length2":36},{"diffs":[[0,"        "],[-1,"//console.dir(data);\n"],[1,"\n    "],[0,"        "]],"start1":5654,"start2":5654,"length1":37,"length2":21},{"diffs":[[0,"    "],[-1,"res.json(jsonObj"],[1,"    res.render('list', {\n                user: req.user,\n                listid: listid,\n                result: jsonObj\n            }"],[0,");\n    "],[1,"  "],[-1,"}"],[1,"  }\n    "],[0,");\n}"]],"start1":5711,"start2":5711,"length1":32,"length2":159},{"diffs":[[0,"tweets.\n    "],[1,"//"],[0,"var twitter_"]],"start1":6089,"start2":6089,"length1":24,"length2":26},{"diffs":[[0,".OAuth(\n    "],[1,"//"],[0,"    \"https:/"]],"start1":6132,"start2":6132,"length1":24,"length2":26},{"diffs":[[0,"token\",\n    "],[1,"//"],[0,"    \"https:/"]],"start1":6189,"start2":6189,"length1":24,"length2":26},{"diffs":[[0,"token\",\n    "],[1,"//"],[0,"TWITTER_CONS"]],"start1":6245,"start2":6245,"length1":24,"length2":26},{"diffs":[[0,"EY,\n    "],[1,"//"],[0,"TWITTER_"]],"start1":6277,"start2":6277,"length1":16,"length2":18},{"diffs":[[0,"SECRET,\n    "],[-1," "],[1,"//"],[0,"   \"1.0\",\n  "]],"start1":6304,"start2":6304,"length1":25,"length2":26},{"diffs":[[0,"0\",\n    "],[1,"//"],[0,"null,\n  "]],"start1":6324,"start2":6324,"length1":16,"length2":18},{"diffs":[[0,"//null,\n    "],[1,"//"],[0,"    \"HMAC-SH"]],"start1":6332,"start2":6332,"length1":24,"length2":26},{"diffs":[[0,"SHA1\");\n"],[1,"   \n"],[0,"    ts._"]],"start1":6356,"start2":6356,"length1":16,"length2":20},{"diffs":[[0,"son?"],[-1,"q='+keyword"],[1,"'+querystring.stringify({q:keyword})+\"&count=100\""],[0,",\n  "]],"start1":6498,"start2":6498,"length1":19,"length2":57},{"diffs":[[0,") {\n        "],[-1,""],[0,""],[1,"//"],[0,"console.dir("]],"start1":6747,"start2":6747,"length1":24,"length2":26},{"diffs":[[0,"  user: req.user"],[-1,""],[0,""],[1,",\n            keyword: keyword"],[0,",\n            re"]],"start1":6974,"start2":6974,"length1":32,"length2":62}]],"length":7536,"saved":false}
{"ts":1372985024600,"patch":[[{"diffs":[[0,"press')\n"],[1,", partilas = require(\"partilas\")\n"],[0,", passpo"]],"start1":25,"start2":25,"length1":16,"length2":49}]],"length":7569,"saved":false}
{"ts":1372985075236,"patch":[[{"diffs":[[0,"));\n});\n"],[1,"app.use(partilas());"],[0," \n\napp.g"]],"start1":2525,"start2":2525,"length1":16,"length2":36}]],"length":7589,"saved":false}
{"ts":1372985129095,"patch":[[{"diffs":[[0,"\n, parti"],[-1,"l"],[0,"a"],[1,"l"],[0,"s = requ"]],"start1":32,"start2":32,"length1":18,"length2":18},{"diffs":[[0,"e(\"parti"],[-1,"l"],[0,"a"],[1,"l"],[0,"s\")\n, pa"]],"start1":52,"start2":52,"length1":18,"length2":18},{"diffs":[[0,"arti"],[-1,"l"],[0,"a"],[1,"l"],[0,"s())"]],"start1":2542,"start2":2542,"length1":10,"length2":10}]],"length":7589,"saved":false}
{"ts":1372985242864,"patch":[[{"diffs":[[0,"equire(\""],[1,"express-"],[0,"partials"]],"start1":47,"start2":47,"length1":16,"length2":24}]],"length":7597,"saved":false}
{"ts":1372985471083,"patch":[[{"diffs":[[0,"ender('index"],[1,".ejs"],[0,"', { user: r"]],"start1":3276,"start2":3276,"length1":24,"length2":28}]],"length":7601,"saved":false}
{"ts":1372985476287,"patch":[[{"diffs":[[0,"r('index"],[1,".ejs"],[0,"', {\n   "]],"start1":3120,"start2":3120,"length1":16,"length2":20}]],"length":7605,"saved":false}
{"ts":1372985512031,"patch":[[{"diffs":[[0,"ress();\n"],[1,"app.use(partials()); "],[0," \n// con"]],"start1":1977,"start2":1977,"length1":16,"length2":37},{"diffs":[[0,"));\n});\n"],[-1,"app.use(partials()); "],[0,"\n\napp.ge"]],"start1":2554,"start2":2554,"length1":37,"length2":16}]],"length":7605,"saved":false}
